<!-- Header -->
<joshies-page-header headerText="Rules">
  @if (viewModel(); as vm) {
    @if (vm.userIsGameMaster) {
      @if (vm.editMode) {
        <!-- Cancel Button -->
        <p-button
          class="ml-auto"
          label="Cancel"
          [text]="true"
          severity="danger"
          (onClick)="confirmCancel()"
        />
      } @else {
        <!-- Edit Button -->
        <i
          tabindex="0"
          class="pi pi-pencil text-700 p-2 ml-auto"
          (click)="enterEditMode()"
          (keyup.enter)="enterEditMode()"
        ></i>
      }
    }
  }
</joshies-page-header>

@if (viewModel(); as vm) {
  @if (vm.rules) {
    @if (vm.editMode) {
      <!-- Form -->
      <joshies-form [form]="vm.form" />
    } @else {
      <!-- Rules -->
      <div [innerHTML]="vm.rules" class="content"></div>

      <!-- Event Rules -->
      <h2>Events</h2>
      @for (event of vm.events; track event.id) {
        <h3
          #eventInfo
          [id]="'event-rules-' + event.id"
          [routerLink]="[]"
          [fragment]="eventInfo.id"
          routerLinkActive="bg-highlight-fadeout"
          [routerLinkActiveOptions]="{
            paths: 'exact',
            fragment: 'exact',
            matrixParams: 'ignored',
            queryParams: 'ignored'
          }"
          class="flex align-items-center gap-3"
          [style]="{ 'padding-top': '6.5rem' }"
        >
          <img
            [ngSrc]="event.image_url || '/assets/icons/icon-96x96.png'"
            alt=""
            height="48"
            width="48"
            class="border-round"
          />
          {{ event.name }} Rules
        </h3>
        <p class="mb-5">{{ event.rules }}</p>
      }
    }
  }
} @else {
  <!-- Loading Skeleton -->
  <p-skeleton width="100%" height="25rem" />
}
